SUBROUTINE DMIXHUM1(P,TK,RH,ISWIT,QW)
  IMPLICIT NONE
  INTEGER ISWIT
  DOUBLE PRECISION P,TK,RH,QW
  DOUBLE PRECISION T0,EP,ONEMEP,ES0,A,B,EST,QST
  T0 = 273.15D0
  EP = 0.622D0
  ONEMEP = 0.378D0
  ES0 = 6.11D0
  A = 17.269D0
  B = 35.86D0
  EST = ES0*EXP((A*(TK-T0))/(TK-B))
  QST = (EP*EST)/(P-ONEMEP*EST)
  QW = QST*(RH*0.01D0)
  IF (ABS(ISWIT) == 2) THEN
    QW = QW / (1.D0 + QW)
  END IF
  IF (ISWIT < 0) THEN
    QW = QW * 1000.D0
  END IF
END SUBROUTINE DMIXHUM1

PROGRAM TestDMIXHUM1
  IMPLICIT NONE
  DOUBLE PRECISION P, TK, RH, QW
  INTEGER ISWIT

  ! Test Cases
  P = 1013.25
  TK = 298.15
  RH = 50.0
  ISWIT = 1
  CALL DMIXHUM1(P, TK, RH, ISWIT, QW)
  PRINT *, 'Test 1: QW=', QW

  P = 1013.25
  TK = 200.0
  RH = 10.0
  ISWIT = -1
  CALL DMIXHUM1(P, TK, RH, ISWIT, QW)
  PRINT *, 'Test 2: QW=', QW
END PROGRAM TestDMIXHUM1